node percona1 attributes IP="192.168.70.2" standby="off"
node percona2 attributes IP="192.168.70.3" standby="off"
node percona3 attributes IP="192.168.70.4" standby="off"


primitive p_MySQL_replication ocf:percona:MySQL_replication \
        params node_prefix="percona" reader_vip_prefix="reader_vip_" ms_replication_resource_name="ms_MySQL_replication" super_db_user="root" super_db_password="" repl_db_user="repl" repl_db_password="repl" allowed_sbm="10" state_file="/var/run/heartbeat/MySQL_replication.state" recover_file="/var/run/heartbeat/MySQL_replication.recovery" p_replication_resource_name="p_MySQL_replication" master_host="192.168.70.2" master_log_file="mysql-bin.000001" master_log_pos="14" recover_seconds="3" heartbeat_table="ocf.heartbeat" promoted_coordinates="::" \
	op monitor interval="5s" role="Master" \
        op monitor interval="5s" role="Slave"

primitive reader_vip_1 ocf:heartbeat:IPaddr2 \
        params ip="192.168.90.1" nic="eth3" \
        meta target-role="Started"
primitive reader_vip_2 ocf:heartbeat:IPaddr2 \
        params ip="192.168.90.2" nic="eth3"
primitive reader_vip_3 ocf:heartbeat:IPaddr2 \
        params ip="192.168.90.3" nic="eth3"
primitive writer_vip ocf:heartbeat:IPaddr2 \
        params ip="190.168.90.99" nic="eth3"

ms ms_MySQL_replication p_MySQL_replication \
        meta master-max="1" master-node-max="1" clone-max="3" clone-node-max="1" notify="false" globally-unique="false" target-role="Master" is-managed="true"

location ms_MySQL_replication_loc_percona1 ms_MySQL_replication 0: percona1
location ms_MySQL_replication_loc_percona2 ms_MySQL_replication 0: percona2
location ms_MySQL_replication_loc_percona3 ms_MySQL_replication 0: percona3
location reader_vip_1_loc_percona1 reader_vip_1 0: percona1
location reader_vip_1_loc_percona2 reader_vip_1 -10000: percona2
location reader_vip_1_loc_percona3 reader_vip_1 -100: percona3
location reader_vip_2_loc_percona1 reader_vip_2 0: percona1
location reader_vip_2_loc_percona2 reader_vip_2 -10000: percona2
location reader_vip_2_loc_percona3 reader_vip_2 -100: percona3
location reader_vip_3_loc_percona1 reader_vip_3 0: percona1
location reader_vip_3_loc_percona2 reader_vip_3 -10000: percona2
location reader_vip_3_loc_percona3 reader_vip_3 -100: percona3
colocation reader_vip_1_dislike_reader_vip_2 -2: reader_vip_1 reader_vip_2
colocation reader_vip_1_dislike_reader_vip_3 -2: reader_vip_1 reader_vip_3
colocation reader_vip_2_dislike_reader_vip_3 -2: reader_vip_2 reader_vip_3
colocation writer_vip_coloc_master inf: ms_MySQL_replication:Master writer_vip
order order_writer_vip_after_master inf: ms_MySQL_replication:promote writer_vip:start

property $id="cib-bootstrap-options" \
	dc-version="1.1.6-3.el6-a02c0f19a00c1eb2527ad38f146ebc0834814558" \
	cluster-infrastructure="openais" \
	expected-quorum-votes="2" \
	stonith-enabled="false" \
	no-quorum-policy="ignore" \
	last-lrm-refresh="1324570695" \
	default-resource-stickiness="INFINITY"

rsc_defaults $id="rsc-options" \
	resource-stickiness="INFINITY" \
	migration-threshold="INFINITY"

